{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\n\nexport default async function getPics(queryWords, pageNum) {\n    axios.defaults.baseURL = \"https://pixabay.com\";\n    const pictures = await axios.get(\"/api/\", {\n        params: {\n            key: \"31908643-2178b12526c513c1beb381d6b\",\n            q: queryWords,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            page: pageNum,\n            per_page: 15,\n        }\n    })\n    console.log(pictures.data);\n    console.log(pictures.data.totalHits);\n    return pictures.data;\n};\n\n\n","const galleryEl = document.querySelector(\".gallery\");\n\n\nexport default function renderGallery (picsArray) {\n    const galleryMarkup = picsArray\n      .map(({largeImageURL, webformatURL, tags, likes, views, comments, downloads}) => `<li class=\"gallery-item\"><a class=\"gallery-link\" href=\"${largeImageURL}\"><img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\"/></a><ul class=\"img-info-list\">\n            <li class=\"img-info-item\">\n              <h3 class=\"img-info-item-header\">Likes</h3>\n              <p class=\"img-info-item-value\">${likes}</p>\n            </li>\n            <li class=\"img-info-item\">\n              <h3 class=\"img-info-item-header\">Views</h3>\n              <p class=\"img-info-item-value\">${views}</p>\n            </li>\n            <li class=\"img-info-item\">\n              <h3 class=\"img-info-item-header\">Comments</h3>\n              <p class=\"img-info-item-value\">${comments}</p>\n            </li>\n            <li class=\"img-info-item\">\n              <h3 class=\"img-info-item-header\">Downloads</h3>\n              <p class=\"img-info-item-value\">${downloads}</p>\n            </li>\n          </ul></li>`)\n        .join(\"\");\n    \n    galleryEl.insertAdjacentHTML(\"beforeend\", galleryMarkup); \n};\n\nexport function clearGallery() {\n    galleryEl.innerHTML = \"\";\n};","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport getPics from \"./js/pixabay-api\";\nimport renderGallery from \"./js/render-functions\";\nimport { clearGallery } from \"./js/render-functions\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst formEl = document.querySelector(\".form\");\nconst loaderEl = document.querySelector(\".loader\")\nconst galleryEl = document.querySelector(\".gallery\");\nconst loadMoreBtnEl = document.getElementById(\"load-more-btn\");\n\nformEl.addEventListener(\"submit\", onSubmit);\nloadMoreBtnEl.addEventListener(\"click\", onLoadMore)\n\nlet pageNum = 1;\nlet queryWords = \"\";\nconst PAGE_LIMIT = 15;\n\nfunction onSubmit(event) {\n    event.preventDefault();\n    clearGallery();\n    loadMoreBtnEl.classList.add(\"visually-hidden\");\n    queryWords = event.currentTarget.searchText.value.trim(\"\");\n    if (queryWords === \"\") {\n        return iziToast.error({\n            theme: 'dark',\n            message: \"Please, fill out the search field.\",\n            backgroundColor: '#EF4040',\n            closeOnClick: true,\n            position: 'topRight',\n            timeout: 3000,\n        })\n    } else {\n        loaderEl.classList.remove(\"visually-hidden\");\n        pageNum = 1;\n        getPics(queryWords, pageNum)\n            .then(response => {\n                const picsArray = response.hits;\n                if (picsArray.length === 0) {\n                    return iziToast.error({\n                        theme: \"dark\",\n                        message: \"Sorry, there are no images matching your search query. Please try again!\",\n                        backgroundColor: \"#EF4040\",\n                        closeOnClick: true,\n                        position: \"topRight\",\n                        timeout: 3000,\n                    })\n                } else {\n                    renderGallery(picsArray);\n                    slGallery.refresh();\n                    if (response.totalHits >= PAGE_LIMIT) {\n                        pageNum += 1;\n                        loadMoreBtnEl.classList.remove(\"visually-hidden\");\n                    } \n                }\n            })\n            .catch(error => {\n                console.log(error);\n                return iziToast.error({\n                    theme: \"dark\",\n                    title: \"Error!\",\n                    message: \"Sorry, something went wrong.\",\n                    backgroundColor: \"#EF4040\",\n                    closeOnClick: true,\n                    position: \"topRight\",\n                    timeout: 3000,\n                    })\n            })\n            .finally(() => {\n            loaderEl.classList.add(\"visually-hidden\");\n        });\n        event.currentTarget.searchText.value = \"\";\n    }\n    \n};\n\nconst slGalleryOptions = {\n  captionDelay: 250,\n  captionsData: \"alt\",\n};\nlet slGallery = new SimpleLightbox('.gallery a', slGalleryOptions);\n \nfunction onLoadMore(event) {\n    getPics(queryWords, pageNum)\n        .then(response => {\n            loaderEl.classList.remove(\"visually-hidden\");\n            const picsArray = response.hits;\n            const totalPics = response.totalHits;\n            const totalPages = getTotalPages(totalPics, PAGE_LIMIT);\n            renderGallery(picsArray);\n            slGallery.refresh();\n            console.log(pageNum);\n            // to check as it's the last page:\n            // if (pageNum >= 3) {\n            if (pageNum >= totalPages) {\n                    loadMoreBtnEl.classList.add(\"visually-hidden\");\n                    return iziToast.info({\n                        theme: \"light\",\n                        message: \"All the pictures have been loaded.\",\n                        backgroundColor: \"#6c8cff\",\n                        closeOnClick: true,\n                        position: \"bottomRight\",\n                        timeout: 5000,\n                    })\n            } else {\n                loadMoreBtnEl.classList.remove(\"visually-hidden\");\n                pageNum += 1;\n                }\n            })\n            .catch(error => {\n                console.log(error);\n                return iziToast.error({\n                    theme: \"dark\",\n                    title: \"Error!\",\n                    message: \"Sorry, something went wrong.\",\n                    backgroundColor: \"#EF4040\",\n                    closeOnClick: true,\n                    position: \"topRight\",\n                    timeout: 3000,\n                    })\n            })\n            .finally(() => {\n            loaderEl.classList.add(\"visually-hidden\");\n        });\n}\n\nfunction getTotalPages(totalPics, PAGE_LIMIT) {\n    console.log(Math.ceil(totalPics / PAGE_LIMIT));\n    const totalPages = Math.ceil(totalPics / PAGE_LIMIT);\n    return totalPages;\n\n}"],"names":["getPics","queryWords","pageNum","axios","pictures","galleryEl","renderGallery","picsArray","galleryMarkup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","clearGallery","formEl","loaderEl","loadMoreBtnEl","onSubmit","onLoadMore","PAGE_LIMIT","event","iziToast","response","slGallery","error","slGalleryOptions","SimpleLightbox","totalPics","totalPages","getTotalPages"],"mappings":"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"}