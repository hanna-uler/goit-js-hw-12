{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst API_KEY = import.meta.env.VITE_API_KEY;\n\nexport default async function getPics(queryWords, pageNum) {\n    axios.defaults.baseURL = \"https://pixabay.com\";\n    const pictures = await axios.get(\"/api/\", {\n        params: {\n            key: API_KEY,\n            q: queryWords,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            page: pageNum,\n            per_page: 15,\n        }\n    })\n    return pictures.data;\n};\n\n\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst galleryEl = document.querySelector(\".gallery\");\nconst slGalleryOptions = {\n  captionDelay: 250,\n  captionsData: \"alt\",\n};\nlet slGallery = new SimpleLightbox('.gallery a', slGalleryOptions);\n\nexport default function renderGallery (picsArray) {\n    const galleryMarkup = picsArray\n      .map(({largeImageURL, webformatURL, tags, likes, views, comments, downloads}) => `<li class=\"gallery-item\"><a class=\"gallery-link\" href=\"${largeImageURL}\"><img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\"/></a><ul class=\"img-info-list\">\n            <li class=\"img-info-item\">\n              <h3 class=\"img-info-item-header\">Likes</h3>\n              <p class=\"img-info-item-value\">${likes}</p>\n            </li>\n            <li class=\"img-info-item\">\n              <h3 class=\"img-info-item-header\">Views</h3>\n              <p class=\"img-info-item-value\">${views}</p>\n            </li>\n            <li class=\"img-info-item\">\n              <h3 class=\"img-info-item-header\">Comments</h3>\n              <p class=\"img-info-item-value\">${comments}</p>\n            </li>\n            <li class=\"img-info-item\">\n              <h3 class=\"img-info-item-header\">Downloads</h3>\n              <p class=\"img-info-item-value\">${downloads}</p>\n            </li>\n          </ul></li>`)\n        .join(\"\");\n    \n    galleryEl.insertAdjacentHTML(\"beforeend\", galleryMarkup); \n    slGallery.refresh();\n};\n\nexport function clearGallery() {\n    galleryEl.innerHTML = \"\";\n};\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport getPics from \"./js/pixabay-api\";\nimport renderGallery from \"./js/render-functions\";\nimport { clearGallery } from \"./js/render-functions\";\n\n\nconst formEl = document.querySelector(\".form\");\nconst loaderEl = document.querySelector(\".loader\")\nconst galleryEl = document.querySelector(\".gallery\");\nconst loadMoreBtnEl = document.getElementById(\"load-more-btn\");\n\nformEl.addEventListener(\"submit\", onSubmit);\nloadMoreBtnEl.addEventListener(\"click\", onLoadMore)\n\nlet pageNum = 1;\nlet queryWords = \"\";\nconst PAGE_LIMIT = 15;\n\nasync function onSubmit(event) {\n    event.preventDefault();\n    clearGallery();\n    loadMoreBtnEl.classList.add(\"visually-hidden\");\n\n    const form = event.currentTarget;\n    const { searchText } = form.elements;\n    queryWords = searchText.value.trim(\"\");\n\n    if (queryWords === \"\") {\n        return iziToast.error({\n            theme: 'dark',\n            message: \"Please, fill out the search field.\",\n            backgroundColor: '#EF4040',\n            messageSize: 16,\n            closeOnClick: true,\n            position: 'topRight',\n            timeout: 3000,\n        })\n    } else {\n        loaderEl.classList.remove(\"visually-hidden\");\n        pageNum = 1;\n        try {\n            const { hits, totalHits } = await getPics(queryWords, pageNum);\n            const picsArray = hits;\n            if (picsArray.length === 0) {\n                return iziToast.error({\n                    theme: \"dark\",\n                    message: \"Sorry, there are no images matching your search query. Please try again!\",\n                    backgroundColor: \"#EF4040\",\n                    closeOnClick: true,\n                    position: \"topRight\",\n                    timeout: 3000,\n                })\n            } else {\n                renderGallery(picsArray);\n                // slGallery.refresh();\n                if (totalHits > PAGE_LIMIT) {\n                    loadMoreBtnEl.classList.remove(\"visually-hidden\");\n                } \n            }\n        } catch(error) {\n            console.log(error);\n            return iziToast.error({\n                theme: \"dark\",\n                title: \"Error!\",\n                message: \"Sorry, something went wrong.\",\n                backgroundColor: \"#EF4040\",\n                messageSize: 16,\n                closeOnClick: true,\n                position: \"topRight\",\n                timeout: 3000,\n            })\n        } finally {\n            loaderEl.classList.add(\"visually-hidden\");\n            form.reset();\n        };\n    }    \n};\n \nasync function onLoadMore(event) {\n    pageNum += 1;\n    loadMoreBtnEl.classList.add(\"visually-hidden\");\n    loaderEl.classList.remove(\"visually-hidden\");\n    try {\n        const { hits, totalHits } = await getPics(queryWords, pageNum);\n        const picsArray = hits;\n        const totalPages = Math.ceil(totalHits / PAGE_LIMIT);\n        renderGallery(picsArray);\n        scroll();\n        // to check the last page:\n        // if (pageNum >= 3) {\n        if (pageNum >= totalPages) {\n            return iziToast.info({\n                theme: \"dark\",\n                message: \"We're sorry, but you've reached the end of the search results.\",\n                backgroundColor: \"#6c8cff\",\n                messageColor: \"#fff\",\n                messageSize: 16,\n                closeOnClick: true,\n                position: \"bottomRight\",\n                timeout: 5000,\n            })\n        } else {\n            loadMoreBtnEl.classList.remove(\"visually-hidden\");\n        }\n    } catch(error) {\n        console.log(error);\n        return iziToast.error({\n            theme: \"dark\",\n            title: \"Error!\",\n            message: \"Sorry, something went wrong.\",\n            backgroundColor: \"#EF4040\",\n            messageSize: 16,\n            closeOnClick: true,\n            position: \"topRight\",\n            timeout: 3000,\n        })\n    } finally {\n            loaderEl.classList.add(\"visually-hidden\");\n    }\n};\n\nfunction scroll() {\n        const picCard = galleryEl.querySelector(\".gallery-item\");\n        const scrollLength = (picCard.getBoundingClientRect().height) * 2;\n        window.scrollBy({\n        top: scrollLength,\n        behavior: \"smooth\",\n        });\n}"],"names":["API_KEY","getPics","queryWords","pageNum","axios","galleryEl","slGalleryOptions","slGallery","SimpleLightbox","renderGallery","picsArray","galleryMarkup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","clearGallery","formEl","loaderEl","loadMoreBtnEl","onSubmit","onLoadMore","PAGE_LIMIT","event","form","searchText","iziToast","hits","totalHits","error","totalPages","scroll","scrollLength"],"mappings":"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"}